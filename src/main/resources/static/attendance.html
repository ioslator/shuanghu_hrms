<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>考勤记录</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    <style>
        body { background-color: #f8f9fa; padding: 20px; }
        .bg-gradient-primary { background: linear-gradient(45deg, #4e73df, #224abe); color: white; }
    </style>
</head>
<body>
<div class="container-fluid">
    <div class="card shadow mb-4">
        <div class="card-header py-3 bg-white d-flex justify-content-between align-items-center">
            <h6 class="m-0 font-weight-bold text-primary">考勤打卡记录</h6>
            <div class="form-inline">
                <input type="date" class="form-control mr-2">
                <button class="btn btn-primary btn-sm">筛选</button>
            </div>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-bordered" width="100%" cellspacing="0">
                    <thead>
                    <tr class="bg-light">
                        <th>日期</th>
                        <th>姓名</th>
                        <th>上班打卡</th>
                        <th>下班打卡</th>
                        <th>工时 (小时)</th>
                        <th>状态</th>
                    </tr>
                    </thead>
                    <tbody id="attendBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        fetch('api/attendance')
            .then(res => res.json())
            .then(render)
            .catch(e => {
                const mock = [
                    {date: '2023-06-01', name: '张三', in: '08:55', out: '18:05', hours: 9.1, status: '正常'},
                    {date: '2023-06-01', name: '李四', in: '09:15', out: '18:00', hours: 8.7, status: '迟到'},
                    {date: '2023-06-01', name: '王五', in: '08:50', out: '17:30', hours: 8.6, status: '早退'},
                ];
                render(mock);
            });
    });

    function render(data) {
        const tbody = document.getElementById('attendBody');
        tbody.innerHTML = '';
        data.forEach(row => {
            let badge = 'success';
            if(row.status === '迟到') badge = 'warning';
            if(row.status === '早退' || row.status === '缺勤') badge = 'danger';

            tbody.innerHTML += `
                    <tr>
                        <td>${row.date || new Date(row.attend_date).toLocaleDateString()}</td>
                        <td>${row.name || row.employeeName}</td>
                        <td>${row.in || row.checkIn || '-'}</td>
                        <td>${row.out || row.checkOut || '-'}</td>
                        <td>${row.hours || '-'}</td>
                        <td><span class="badge badge-${badge}">${row.status}</span></td>
                    </tr>
                `;
        });
    }
</script>
</body>
</html>